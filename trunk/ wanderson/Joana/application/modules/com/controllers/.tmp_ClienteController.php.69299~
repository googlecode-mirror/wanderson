<?php
	class Com_ClienteController extends System_Controller_Action {
		public function indexAction() {
			$form = new System_Form_FastCliente();
			$form->nome->setAttrib('onkeyup', 'javascript:search();');
			$form->email->setAttrib('onkeyup', 'javascript:search();');
			$this->view->form = $form;
		}
		public function fastAction() {
			$view   = new System_View();
			$table  = new Com_Cliente();
			$filter = new Zend_Filter();
			$filter
				->addFilter(new Zend_Filter_StripTags())
				->addFilter(new Zend_Filter_StringTrim());
			
			$nome   = $this->getRequest()->getParam('nome');
			$nome   = $filter->filter($nome);
			$nome   = $table->getAdapter()->quoteInto('nome ILIKE ?', '%'.$nome.'%');
			
			$where  = array($nome);
			$view->clientes = $table->fetchAll($where,'nome',10);
			
			$this->view->consulta = $view->render('consulta.phtml');
			$this->view->layout()->disableLayout();
		}
	}
